{
  "swagger": "2.0",
  "info": {
    "description": "王凯舸 周猛 南通大学软件工程2018届毕业设计项目",
    "version": "1.0.0",
    "title": "书圈系统"
  },
  "host": "104.194.94.3:3002",
  "basePath": "/bookcircle",
  "schemes": [
    "http"
  ],
  "paths": {
    "/user/register": {
      "post": {
        "tags": [
          "用户"
        ],
        "summary": "此接口提供用户注册的功能",
        "description": "用户首次进入该系统, 注册账号获取登录凭证",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "用户基本信息",
            "required": true,
            "schema": {
              "$ref": "#/definitions/UserInfo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "用户注册账号请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                }
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/user/login": {
      "post": {
        "tags": [
          "用户"
        ],
        "summary": "此接口是用户登录",
        "description": "用户登录",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "用户登录的账号和密码",
            "required": true,
            "schema": {
              "$ref": "#/definitions/loginParams"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "用户登录请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                }
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/user/update": {
      "post": {
        "tags": [
          "用户"
        ],
        "summary": "此接口用于更新用户信息",
        "description": "用户更新个人信息, 包括密码、个人头像",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
           {
             "in": "body",
             "name": "body",
             "required": true,
             "description": "用户个人信息",
             "schema": {
               "$ref": "#/definitions/updateParams"
             }
           }
        ],
        "responses": {
         "200": {
           "description": "用户更新个人信息请求成功",
           "schema": {
             "type": "object",
             "properties": {
               "errorCode": {
                 "$ref": "#/definitions/ResultCode"
               },
               "errorMsg": {
                 "type": "string",
                 "description": "返回描述"
               }
             }
           }
         },
         "400": {
           "description": "请求错误"
         }
       }
      }
    },
    "/user/query": {
      "get": {
        "tags": [
          "用户"
        ],
        "summary": "此接口用于搜索查找相应用户",
        "description": "搜索查找用户",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "pageIndex",
            "in": "query",
            "description": "分页的页码",
            "required": true,
            "type": "number",
            "format": "int"
          },
          {
            "name": "keyWord",
            "in": "query",
            "description": "查询用户的关键字",
            "type": "string",
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "搜索用户请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                },
                "data": {
                  "type": "array",
                  "items": {
                    "$ref":"#/definitions/UserInfo"
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/book/new": {
      "get": {
        "tags": [
          "图书"
        ],
        "summary": "此接口用于查询新上架的图书",
        "description": "用户进入首页, 系统获取最新上架的图书",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "pageIndex",
            "in": "query",
            "description": "分页查询的页码",
            "required": true,
            "type": "number",
            "format": "int"
          },
          {
            "name": "keyWord",
            "in": "query",
            "description": "模糊查询的关键字",
            "required": true,
            "type": "string",
            "default": ""
          }
        ],
        "responses": {
          "200": {
            "description": "获取最新上架的图书成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                },
                "data": {
                  "type": "array",
                  "items": {
                    "$ref":"#/definitions/BookInfo"
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/book/hot": {
      "get": {
        "tags": [
          "图书"
        ],
        "summary": "此接口用于查询热门畅销的图书",
        "description": "用户进入首页, 系统获取最近热门畅销的图书",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "pageIndex",
            "in": "query",
            "description": "分页查询的页码",
            "required": true,
            "type": "number",
            "format": "int"
          },
          {
            "name": "keyWord",
            "in": "query",
            "description": "模糊查询的关键字",
            "required": true,
            "type": "string",
            "default": ""
          }
        ],
        "responses": {
          "200": {
            "description": "获取热门畅销图书成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                },
                "data": {
                  "type": "array",
                  "items": {
                    "$ref":"#/definitions/BookInfo"
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/book/recommend": {
      "get": {
        "tags": [
          "图书"
        ],
        "summary": "此接口用于查询相应用户推荐的图书",
        "description": "用户进入首页, 系统根据用户的喜好和所读书籍进行推荐图书",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "pageIndex",
            "in": "query",
            "description": "分页查询的页码",
            "required": true,
            "type": "number",
            "format": "int"
          },
          {
            "name": "userId",
            "in": "query",
            "description": "用户ID",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "用户更新个人信息请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                },
                "data": {
                  "type": "array",
                  "items": {
                    "$ref":"#/definitions/BookInfo"
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/userbook/storeup": {
      "post": {
        "tags": [
          "图书"
        ],
        "summary": "此接口用于用户添加收藏的书籍",
        "description": "用户收藏某本书籍",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "收藏的书的信息",
            "required": true,
            "schema": {
              "$ref":"#/definitions/StoredInfo"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "用户收藏某本书籍请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                }      
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/friend/add": {
      "post": {
        "tags": [
          "用户好友"
        ],
        "summary": "此接口用于用户添加好友",
        "description": "用户添加好友",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "description": "添加好友时所需的参数",
            "required": true,
            "schema": {
              "$ref":"#/definitions/FriendParams"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "用户添加好友请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                }      
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/friend/delete": {
      "post": {
        "tags": [
          "用户好友"
        ],
        "summary": "此接口用于用户取消关注好友",
        "description": "用户取消关注好友、删除好友",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "description": "取关好友时所需的参数",
            "required": true,
            "schema": {
              "$ref":"#/definitions/FriendParams"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "用户取关好友请求成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                }      
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    },
    "/friend/query": {
      "get": {
        "tags": [
          "用户好友"
        ],
        "summary": "此接口用于查询某个用户的好友列表",
        "description": "获取用户的好友列表",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "name": "userId",
            "in": "query",
            "description": "用户的ID",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "获取用户好友列表成功",
            "schema": {
              "type": "object",
              "properties": {
                "errorCode": {
                  "$ref": "#/definitions/ResultCode"
                },
                "errorMsg": {
                  "type": "string",
                  "description": "返回描述"
                },
                "data": {
                  "type": "array",
                  "items": {
                    "$ref":"#/definitions/UserInfo"
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求错误"
          }
        }
      }
    }
  },
  "definitions": {
    "UserInfo": {
      "type": "object",
      "properties": {
        "phoneNumber": {
          "type": "string",
          "description": "用户手机号"
        },
        "password": {
          "type": "string",
          "description": "用户登录密码"
        },
        "nickName": {
          "type": "string",
          "description": "用户昵称"
        },
        "sex" : {
          "type": "number",
          "format": "byte",
          "default": 0,
          "description": "用户性别: 0 - '女'; 1 - '男'"
        },
        "birthday": {
          "type": "string",
          "description": "用户生日"
        },
        "provinceName": {
          "type": "string",
          "description": "省份名称"
        },
        "cityName": {
          "type": "string",
          "description": "城市名称"
        },
        "university": {
          "type": "string",
          "description": "大学名称"
        },
        "headIcon": {
          "type": "string",
          "description": "用户的头像"
        },
        "description": {
          "type": "string",
          "description": "用户的自我描述"
        },
        "QRCode": {
          "type": "string",
          "description": "用户的二维码, url"
        },
        "hobbies": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "用户的喜好"
        },
        "createTime": {
          "type": "string",
          "description": "该账号的创建时间"
        },
        "updateTime": {
          "type": "string",
          "description": "该账号的更新时间"
        }
      },
      "required": [
        "phoneNumber",
        "password",
        "nickName"
      ]
    },
    "loginParams": {
      "type": "object",
      "properties": {
        "phoneNumber": {
          "type": "string",
          "description": "用户手机号"
        },
        "password": {
          "type": "string",
          "description": "用户登录密码"
        }
      },
      "required": [
        "phoneNumber",
        "password"
      ]
    },
    "updateParams": {
      "type": "object",
      "description": "用户更新的个人信息",
      "properties": {
        "phoneNumber": {
          "type": "string",
          "description": "用户手机号"
        },
        "password": {
          "type": "string",
          "description": "用户密码"
        },
        "sex": {
          "type": "number",
          "format": "byte",
          "description": "用户性别: 0 - '女'; 1 - '男'"
        },
        "birthday": {
          "type": "string",
          "description": "用户生日"
        },
        "provinceName": {
          "type": "string",
          "description": "省份"
        },
        "cityName": {
          "type": "string",
          "description": "城市"
        },
        "university": {
          "type": "string",
          "description": "学校"
        },
        "headIcon": {
          "type": "string",
          "description": "个人头像"
        }
      },
      "required": [
        "phoneNumber"
      ]
    },
    "BookInfo": {
      "type": "object",
      "properties": {
        "isbn": {
          "type": "string",
          "description": "图书的ISBN"
        },
        "author": {
          "type": "string",
          "description": "作者"
        },
        "title": {
          "type": "string",
          "description": "书名"
        },
        "publisher": {
          "type": "string",
          "description": "出版商"
        },
        "price": {
          "type": "number",
          "format": "float",
          "description": "书的价格"
        },
        "summary": {
          "type": "string",
          "description": "书的概述"
        }
      },
      "required": [
        "isbn",
        "author",
        "title",
        "publisher",
        "price",
        "summary"
      ]
    },
    "HobbyInfo": {
      "type": "object",
      "properties": {
        "tag": {
          "type": "string",
          "description": "喜好标签"
        },
        "count": {
          "type": "number",
          "format": "int",
          "description": "数量"
        }
      },
      "required": [
        "tag"
      ]
    },
    "StoredInfo": {
      "type": "object",
      "properties": {
        "userId": {
          "type": "string",
          "description": "用户ID"
        },
        "isbn": {
          "type": "string",
          "description": "书籍的ISBN"
        }
      },
      "required": [
        "userId",
        "isbn"
      ]
    },
    "FriendParams": {
      "type": "object",
      "properties": {
        "userId": {
          "type": "string",
          "description": "用户ID"
        },
        "friendId": {
          "type": "string",
          "description": "好友ID"
        }
      },
      "required": [
        "userId",
        "friendId"
      ]
    },
    "ResultCode": {
      "type": "number",
      "enum": [
        0, // 成功
        2, // 请求错误
        4, // 数据库操作错误
        5, // manaager层操作错误
        1001, // 参数错误
        2001, // 用户不存在
        2002, // 用户已存在
        2003, // 账号异常, 黑名单
        2004, // 密码错误
        2005, // 更新用户信息失败
        2006, // 书籍已被收藏
        2007  // 用户已被添加为好友
      ]
    }
  }
}